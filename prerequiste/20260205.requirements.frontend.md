# Product Requirements Document (PRD)

## Product Name
**Accounting & Invoicing UI**  
**Version:** v1.1 (Role-Agnostic)

---

## 1. Executive Summary

The Accounting & Invoicing UI provides a **tenant-scoped user interface** to review financial transactions by account and to list, view, and manage invoices generated by the Dual-Entry Accounting Service.

The UI enables:
- Transparent visibility into ledger transactions per account
- Easy navigation between accounts, transactions, and invoices
- Invoice listing, review, and limited editing of non-financial metadata

This UI acts as a **read-heavy operational interface** and does not perform any accounting logic.

---

## 2. Business Intent

### 2.1 Problem Statement

As billing volume increases across organizational and individual accounts:
- Finance and operations teams need visibility into transactions
- Invoice review requires backend support
- Investigating balances is time-consuming and error-prone

Without a dedicated UI:
- Ledger data remains inaccessible to business users
- Invoice validation becomes inefficient
- Support teams struggle to answer billing queries

---

### 2.2 Business Goals

- Provide **clear, account-level visibility** into transactions
- Enable **easy invoice review and management**
- Reduce dependency on engineering teams
- Improve operational efficiency and audit readiness
- Lay groundwork for future enhancements (RBAC, fleet reporting)

---

### 2.3 Target Users

- Any authenticated user within a tenant
- Finance, operations, or support personas (not enforced by system)

---

## 3. Scope of Work

### 3.1 In Scope

- Account listing and selection
- Ledger / transaction review by account
- Invoice listing and detail views
- Limited invoice metadata editing
- Invoice PDF download
- Tenant isolation

---

### 3.2 Out of Scope

- Role-based access control
- Editing ledger entries
- Creating charges or payments
- Tax handling
- Credit notes or adjustments
- Fleet-wise financial dashboards

---

## 4. Key Concepts (UI Perspective)

### 4.1 Account

Represents the financially responsible entity:
- Organization (Hospital, Rehab Center, etc.)
- Individual (Passenger, Guardian)

Each account has:
- Ledger entries
- Invoices
- Current balance

---

### 4.2 Ledger Entry

- System-generated
- Immutable
- Displayed for review only
- Represents either a Ride charge or a Payment

---

### 4.3 Invoice

- Generated by backend service
- Financially immutable
- Editable only for non-financial metadata

---

## 5. Functional Requirements

---

## 5.1 Account Views

### FR-1: Account List View
- UI shall display a list of accounts within the tenant
- Columns:
  - Account Name
  - Account Type (Organization / Individual)
  - Current Balance (USD)
  - Last Invoice Date
  - Status

---

### FR-2: Account Detail View
- Selecting an account opens a detailed view
- Tabs:
  - Account Summary
  - Transactions
  - Invoices

---

## 5.2 Transaction (Ledger) Review

### FR-3: Ledger List View
- UI shall list ledger entries for the selected account
- Columns:
  - Posting Date
  - Source Type (Ride / Payment)
  - Source Reference ID
  - Debit Amount
  - Credit Amount
  - Running Balance

---

### FR-4: Ledger Filters
- Users can filter transactions by:
  - Date range
  - Source type
  - Amount range

---

### FR-5: Ledger Entry Detail View
- Clicking a ledger entry shows:
  - Full metadata
  - Linked Ride ID or Payment ID
  - Linked Invoice (if applicable)

---

### FR-6: Ledger Read-Only Enforcement
- UI must not allow:
  - Editing
  - Deleting
  - Reposting ledger entries

---

## 5.3 Invoice Management

### FR-7: Invoice List View
- UI shall display invoices for the selected account
- Columns:
  - Invoice Number
  - Billing Period
  - Invoice Frequency (Per Ride / Daily / Weekly / Monthly)
  - Total Amount
  - Amount Paid
  - Outstanding Amount
  - Status

---

### FR-8: Invoice Detail View
Invoice detail page shall display:
- Account information
- Billing period
- Line items:
  - Ride ID
  - Service Date
  - Fare
- Subtotal
- Payments applied
- Outstanding balance

---

### FR-9: Invoice Download
- Users can download invoices as PDF
- Downloaded PDF must match backend invoice exactly

---

## 5.4 Invoice Editing (Metadata Only)

### FR-10: Editable Invoice Fields
UI shall allow editing of **non-financial metadata only**, such as:
- Invoice notes
- Internal reference
- Billing contact details

---

### FR-11: Non-Editable Invoice Fields
UI must prevent editing of:
- Invoice amount
- Line items
- Applied payments
- Ledger references

---

### FR-12: Invoice Audit Information
Invoice view shall show:
- Invoice creation date
- Generated by (system)
- Last metadata update timestamp

---

## 5.5 Navigation & UX

### FR-13: Cross-Link Navigation
- Users can navigate:
  - Invoice → related ledger entries
  - Ledger entry → linked invoice
  - Ledger entry → Ride or Payment reference (read-only)

---

### FR-14: Performance Expectations
- Ledger list load < 2 seconds (last 90 days)
- Invoice list load < 1 second

---

## 5.6 Tenant Isolation

### FR-15: Tenant Boundary Enforcement
- UI must display data only for the active tenant
- No cross-tenant data access allowed

---

## 6. Non-Functional Requirements

- Desktop-first responsive UI
- Pagination for large ledgers
- Consistent currency formatting (USD)
- Strong consistency with backend state
- Clear audit-friendly presentation

---

## 7. Assumptions & Future Enhancements

### Assumptions
- All users are trusted within a tenant
- No RBAC enforcement in UI or backend
- USD-only amounts
- Ledger and invoices are authoritative from backend

---

### Future Enhancements
- Role-based access control
- Fleet-wise revenue dashboards
- Invoice adjustments & credit notes
- Aging reports
- Bulk invoice actions
